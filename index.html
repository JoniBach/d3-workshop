<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D3.js Workshop - NASA Asteroid Visualizations</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- D3.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
    <header>
        <h1>üöÄ D3.js Workshop: NASA Asteroid Visualizations</h1>
        <p>Exploring Near-Earth Objects (NEO) data from January 1-8, 2024</p>
        <div id="data-summary"></div>
        <div id="loading" class="loading">Loading asteroid data...</div>
    </header>

    <main id="dashboard">
        <!-- Dashboard will be dynamically generated by chart_registry.js -->
    </main>

    <footer>
        <p>Data source: <a href="https://api.nasa.gov/" target="_blank">NASA NeoWs API</a></p>
        <p>Built with <a href="https://d3js.org/" target="_blank">D3.js v7.8.5</a></p>
    </footer>

    <!-- Configuration (API Key) -->
    <script src="config.js"></script>
    
    <!-- Data Fetcher -->
    <script src="js/data_fetcher.js"></script>
    
    <!-- Chart Registry (must load before visualizations) -->
    <script src="js/chart_registry.js"></script>

    <!-- Visualization Scripts -->
    <script src="js/bar_chart.js"></script>
    <script src="js/horizontal_bar.js"></script>
    <script src="js/grouped_bar.js"></script>
    <script src="js/stacked_bar.js"></script>
    <script src="js/pie_chart.js"></script>
    <script src="js/donut_chart.js"></script>
    <script src="js/histogram.js"></script>
    <script src="js/box_plot.js"></script>
    <script src="js/violin_plot.js"></script>
    <script src="js/scatter_plot.js"></script>
    <script src="js/bubble_chart.js"></script>
    <script src="js/heatmap.js"></script>
    <script src="js/line_chart.js"></script>
    <script src="js/area_chart.js"></script>
    <script src="js/stream_graph.js"></script>
    <script src="js/timeline.js"></script>
    <script src="js/treemap.js"></script>
    <script src="js/sunburst.js"></script>
    <script src="js/force_directed.js"></script>
    <script src="js/sankey.js"></script>

    <!-- Main initialization script -->
    <script>
        // Initialize the dashboard when page loads
        async function initDashboard() {
            try {
                // Fetch and process data first
                const data = await initializeData();
                
                // Build dashboard structure dynamically from chart registry
                // (do this after data loads to ensure all scripts are loaded)
                buildDashboard();
                
                // Hide loading indicator
                document.getElementById('loading').style.display = 'none';
                
                // Show data summary
                const summary = document.getElementById('data-summary');
                summary.innerHTML = `
                    <div class="summary-stats">
                        <span class="stat">Total Asteroids: <strong>${data.total_count}</strong></span>
                        <span class="stat hazardous">Hazardous: <strong>${data.hazardous_count}</strong></span>
                        <span class="stat safe">Non-Hazardous: <strong>${data.non_hazardous_count}</strong></span>
                    </div>
                `;
                
                // Render all visualizations using registry
                renderAllCharts(data);
                
                console.log('‚úÖ All visualizations rendered!');
            } catch (error) {
                console.error('‚ùå Error initializing dashboard:', error);
                document.getElementById('loading').innerHTML = '‚ùå Error loading data. Please refresh the page.';
            }
        }

        // Start the dashboard when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initDashboard);
        } else {
            initDashboard();
        }
    </script>
</body>
</html>
